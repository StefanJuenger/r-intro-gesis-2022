---
title: 'Exercise 1_2_3: Statistical Software Files'
author: 'Johannes Breuer, Stefan JÃ¼nger, Veronika Batzdorfer'
date: 'Introduction to R for Data Analysis'
---

```{r child = "./content/config/exercises_setup.Rmd"}
```

In this set of exercises, we will work with files from statistical software. The first tasks are about importing data, while the later ones are about labelling and exporting.

```{block, box.title = "1", box.body = list(fill = "white"), box.icon = "fa-star"}
Import the `.sav` version of the data from the *German General Social Survey - ALLBUS 2021*.
```

```{block, opts.label = "clues"}
You need the `haven` package for this. The file should be stored in the `data` folder.
```

```{r load_gp, solution = TRUE}
library(haven)

allbus_2021 <- read_spss("./data/allbus_2021/ZA5280_v1-0-0.sav")
```

Unlike in flat files, such as CSV, the variables now have labels.

```{block, box.title = "2", box.body = list(fill = "white"), box.icon = "fa-star"}
Print the labels of the first ten variables in the data set.
```

```{block, opts.label = "clues"}
You can use a function from the `sjlabelled` package for this. Remember that you can use [ ] ro subset columns/variables (we only want to print the labels for the first ten variables).
```

```{r print_labels, solution = TRUE, message = FALSE}
library(sjlabelled)

get_label(allbus_2021[1:10])
```

Unfortunately, it's all in German. Imagine you are a political scientist working on a publication in English, and you are interested in the variable `pa01` (left-right self-placement). So you may want to consider translating the variable into English.

```{block, box.title = "3", box.body = list(fill = "white"), box.icon = "fa-star"}
Change the variable label of `pa01` from "LINKS-RECHTS-SELBSTEINSTUFUNG, BEFR." to "left-right self-placement".
```

```{block, opts.label = "clues"}
You can, again, use a function from `sjlabelled` for this.
```

```{r changevarlabel, solution = TRUE, message = FALSE}
allbus_2021$pa01 <- 
  set_label(
    allbus_2021$pa01, 
    label = "left-right self-placement"
  )
get_label(allbus_2021$pa01)
```

Your collaborators ask you to share the data after changing labels and stuff. Unfortunately, they do not use `R`, `SPSS` or even `Stata` and, hence, asks you to export your data as a *SAS* file.

```{block, box.title = "4", box.body = list(fill = "white"), box.icon = "fa-star"}
Export your data as a *SAS* file (its file extension is `sas7bdat`).
```

```{block, opts.label = "clues"}
The `haven` package provides a function for writing such files that is called and works in a similar way as the corresponding function for importing data in this particular format.
```

```{r exportstata, solution = TRUE, eval = FALSE}
write_sas(gp_covid, "Allbus_SAS_format.sas7bdat)
```
